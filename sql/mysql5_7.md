## 数据库

- mysql：必需的，用于描述用户访问权限
- user ： show view的权限
- information_schema.views表中存储了所有视图的定义

### 数据表的基本操作
- 创建表
    - 主键：primary key
    - 外键约束：（constraint <外键名> foreign key 字段名1，字段名2  references <主表名> 主键列1，主键列2）
    - 非空约束：not null
    - 唯一性约束：unique
    - 默认约束：default
    - 表的属性值自动增加：auto_increment

- 查看表结构
    - 查看表基本结构语句：desc table_name
        - null：表示该列是否可以存储null值
        - key：表示该列是否已编制索引。PRI表示该列是表主键的一部分；UNI表示该列是unique索引的一部分；MUL表示在列中某个给定值允许出现多次
        - default；表示该列是否有默认值，如果有的话值是多少
        - extra：表示可以获取的与给定列有关的附加信息，例如auto_increment等
    - 查看表详细结构语句：show create table table_name
 
- 修改数据表
    - 修改表名：alter table <旧表名> rename <新表名>；
    - 修改字段的数据类型：alter table <表名> modify <字段名> <数据类型>；
    - 修改字段名：alter table <表名> change <旧字段名> <新字段名> <新数据类型>；
    - 添加字段：alter table <表名> add <新字段名> <数据类型> [约束条件] [first | after 已存在字段名];
      - first：将新添加的字段设置为表的第一个字段
      - after：将新添加的字段添加到指定的"已存在字段名"的后面
    - 删除字段：a lter table <表名> drop <字段名>；
    - 修改字段的排列位置：alter table <表名> modify <字段1> <数据类型> first｜after <字段2>；
    - 更改表的存储引擎：alter table <表名> engine=<更改后的存储引擎名>；
        - mysql主要的存储引擎：MyISAM、InnoDB、MEMORY(HEAP)、BDB、FEDERATED
        - 查看系统支持的存储引擎：show engines;
    - 删除表的外键约束：alter table <表名> drop foreign key <外键约束名>；

- 删除数据表
    - 删除没有被关联的表：drop table [if exists] table_name，table_name1。。。
    - 删除被其他表关联的主表：
        - 1.先删除外键约束条件
        - 2.然后删除父表
  
### 数据类型和运算符
- 数值数据类型：
    - 整数类型：tinyint，smallint，mediumint，int(integer)，bigint        
    - 浮点小数数据类型：float，double
    - 定点小数类型：decimal
      - 不论是定点还是浮点类型，如果用户指定的精度超出精度范围，就会四舍五入进行处理
- 日期/时间类型：year，time，date，datetime，timestamp
    - time:系统当前的日期时间函数：CURRENT_TIME,NOW()
    - date:当前系统日期：CURRENT_DATE,NOW()
    - datetime在存储日期数据时，按实际输入的格式存储，即输入什么就存储什么，与时区无关； 
    - timestamp值的存储是以UTC格式保存的，存储时对当前时区进行转化，检索时再转换回当前时区，即查询时，根据当前时区的不同，显示的时间值时不同的
- 字符串类型：char，varchar，binary，varbinary，blob，text，enum，set
    - 分为文本字符串和二进制字符串
    - 文本字符串：char，varchar，text，enum，set
    - 二进制字符串：bit，binary，varbinary，tinyblob，blob，mediumblob，longblob
        - BIN()函数将数字转换为二进制
### 函数
- 数学函数
    - 绝对值函数
        - 绝对值函数 ABS(x) ：返回x的绝对值
        - 圆周率的函数 PI() : 返回圆周率的值，返回结果保留了7位有效数字
        - 平方根函数 SQRT(x) ：返回非负数x的平方根
        - 求余函数 MOD(x,y) : 返回x被y除后的余数，对带有小数部分的数值也起作用，它返回除法运算后的精确余数
        - 获取整数的函数 
            - CEIL(x)、CEILING(x) : 意义相同，返回不小于x的最小整数值，返回值转化为一个BIGINT
            - FLOOR(x) ： 返回不大于x的最大整数值，返回值转化为一个BIGINT
        - 获取随机数的函数： 返回一个随机浮点值v，范围在0到1之间。若已指定一个整数参数x，则它被用作种子值，用来产生重复序列
            - RAND() ： 每次产生的随机数值是不同的
            - RAND(x) ： 当RAND(x)的参数相同时，将产生相同的随机数，不同的x产生的随机数值不同
        - ROUND(x) : 返回最接近参数x的整数，对x值进行四舍五入
        - ROUND(x,y) ： 返回最接近参数x的数，其值保留到小数点后面y位，若y为负值，则将保留x值到小数点左边y位，保留的小数点左边的相应位数直接保存为0，不进行四舍五入
        - TRUNCATE(x,y) ： 返回被舍去至小数点后y位的数字x，若y的值为0，则结果不带小数点或不带小数部分，若y设为负数，则截去(归零)x小数点左起第y位开始后面所有低位的值
        - 符号函数 SIGN(x) ： 返回参数的符号，x的值为负、零或正时返回结果依次为-1、0或1
        - 幂运算函数 
            - POW(x,y)、POWER(x,y) ： 返回x的y次方的结果值 
            - EXP(x) ： 返回e的x次方的值
    - 三角函数
        - 正弦函数 SIN(x)：返回x的正弦值，其中x为弧度值
        - 反正弦函数 ASIN(x) ： 返回x的反正弦值，即正弦为x的值。若x不在-1～1的范围之内，则返回NULL
        - 余弦函数 COS(x) : 返回x的余弦值，其中x为弧度值
        - 反余弦函数 ACOS(x) : 返回x的反余弦值，即余弦是x的值。若x不在-1～1的范围之内，则返回NULL
        - 正切函数 TAN(x) ： 返回x的正切值，其中x为给定的弧度值
        - 反正切函数 ATAN(x) ： 返回x的反正切值，即正切为x的值  
        - 余切函数 COT(x) ： 返回x的余切值
    - 对数函数
        - 对数运算函数
            - LOG(x) ： 返回x的自然对数，x相当于基数e的对数，对数定义域不能为负数
            - LOG10(x) ： 返回x的基数为10的对数
        - 角度与弧度相互转换的函数
            - RADIANS(x) : 将参数x由角度转化为弧度
            - DEGREES(x) : 将参数x有弧度转化为角度
    - 随机数函数
- 字符串函数
    - 计算字符串长度函数
        - char_length(str) ： 返回值为字符串str所包含的字符个数。一个多字节字符算作一个单字符
        - length(str) ： 返回值为字符串的字节长度，使用utf8编码字符集时，一个汉子是3字节，一个数字或字母是一字节
    - 字符串合并函数
        - concat(s1,s2, ...) ： 返回结果为连续参数产生的字符串，或许有一个或多个参数。若任何一个参数为null，则返回值为null。若所有参数均为非二进制字符串，则结果为非二进制字符串。若自变量中含有任一二进制字符串，则结果为一个二进制字符串
        - concat_ws(x,s1,s2,...) 中，concat_ws代表concat With Separator，是concat()的特殊形式。第一个参数x是其他参数的分隔符，分隔符放在要连接的两个字符串之间。分隔符可以是一个字符串，也可以是其他参数。若分隔符为null，则结果为null，函数会忽略任何分隔符参数后的null
    - 字符串替换函数
        - 替换字符串的函数 insert(s1,x,len,s2) ： 返回字符串s1，其子字符串起始于x位置和被字符串s2取代的len字符。若x超过字符串长度，则返回值为原始字符串。若len的长度大于其他字符串的长度，则从位置x开始替换。若任何一个参数为null，则返回值为null
        - 字母大小写转化函数 
            - lower(str) 或 lcase(str) 可以将字符串str中的字母字符全部转换成小写字母
            - upper(str) 或 ucase(str) 可以将字符串str中的字母字符全部转化成大写字母
        - 获取指定长度的字符串的函数
            - left(s,n) ： 返回字符串s开始最左边的n个字符
            - right(s,n) ： 返回字符串s最右边的n个字符
        - 填充字符串的函数
            - lpad(s1,len,s2) ： 返回字符串s1，其左边由字符串s2填补到len字符长度。若s1的长度大于len，则返回值被缩短至len字符
            - rpad(s1,len,s2) ： 返回字符串s1，其右边被字符串s2填补至len字符长度，若字符串s1的长度大于len，则返回值被缩短到len字符长度
        - 删除空格的函数
            - ltrim(s) ： 返回字符串s，字符串左侧空格字符被删除
            - rtrim(s) ： 返回字符串s，字符串右侧空格字符被删除
            - trim(s) ： 删除字符串s两侧的空格
        - 删除指定字符串的函数 
            - trim(s1 from s) ： 删除字符串s中两端所有的子字符串s1，s1为可选项，在未指定的情况下，删除空格
        - 重复生成字符串的函数
            - repeat(s,n) ： 返回一个由重复的字符串s组成的字符串，字符串s的数目等于n。若n小于等于0，<=，则返回一个空字符串，若s或n为null，则返回null
        - 空格函数 space(n) ： 返回一个由n个空格组成的字符串
        - 替换函数 replace(s,s1,s2) ： 使用字符串s2替换字符串s中所有的字符串s1 
    - 字符串比较函数
        - 比较字符串大小的函数 strcmp(s1,s2) ： 若strcmp(s1,s2)所有的字符串均相同，则返回0；若根据当前分类次序，第一个参数小于第二个，则返回-1；其他情况返回1。
    - 查找指定字符串位置函数
        - 获取子串的函数
            - substring(s,n,len) ： 带有len参数的格式，从字符串s返回一个长度同len字符相同的子字符串，起始于位置n，也可能对n使用一个负值。假若这样，子字符串的位置起始于字符串结尾n的字符，即倒数第n个字符，而不是字符串的开头位置。若对len使用的是一个小于1的值，则结果始终为空字符串
            - mid(s,n,len) ： 与substring(s,n,len)的作用相同
        - 匹配子串开始位置的函数
            - locate(str1,str)、position(str1 IN str)、instr(str,str1) ： 返回子字符串str1在字符串str中的开始位置
        - 字符串逆序的函数 reverse(s) ： 将字符串s反转，返回的字符串的顺序和s字符串的顺序相反
        - 返回指定位置的字符串的函数 elt(n,字符串1，字符串2，。。。字符串n)中，若n=1，则返回值为字符串1；若n=2，则返回值为字符串2；以此类推。若n小于1或大于参数的数目，则返回值为null
        - 返回指定字符串位置的函数 field(s,s1,s2,...) ： 返回字符串s在列表s1，s2，。。中第一次出现的位置，在找不到s的情况下，返回值为0，若s为null，则返回值为0，原因是null不能与任何值进行同等比较
        - 返回子串位置的函数 find_in_set(s1,s2) ： 返回字符串s1在字符串列表s2中出现的位置，字符串列表是一个由多个逗号分开的字符串组成的列表。若s1不在s2中或s2为空字符串，则返回值为0，若任意一个参数为null，则返回值为null，这个函数在第一个参数包含一个逗号时将无法正常运行
        - 选取字符串的函数make_set(x,s1,s2,...) ： 函数按x的二进制数从s1，s2，。。。中选取字符串。
- 日期和时间函数
    - 获取当前日期的函数 curdate() 和 current_date() 函数的作用相同，将当前日期按照"YYY-MM-DD"或YYYMMDD格式的值返回，具体格式根据函数在字符串或数字语境中而定
    - 获取当前时间的函数 curtime() 和 current_time() 函数的作用相同，将当前时间按照"HH:MM:SS"或HHMMSS格式返回，具体格式根据函数在字符串或数字语境中而定
    - 获取当前日期和时间的函数 current_timestamp()、localtime()、now() 和 sysdate() 4个函数的作用相同，均返回当前日期和时间值，格式为""YYYY-MM-DD HH:MM:SS"或YYYYMMDDHHMMSS，具体格式根据函数在字符串或数字语境中而定
    - unix时间戳函数 
        - unix_timestamp(date) ： 若无参数调用，则返回一个unix时间戳('1970-01-01 00:00:00'GMT之后的秒数) 作为无符号整数。其中，GMT为格林尼治标准时间。若用date调用unix_timestamp(),则会将参数值以'1970-01-01 00:00:00' GMT后的秒数的形式返回。date可以是一个date字符串、datetime字符串、timestamp或一个当地时间的YYMMDD或YYYYMMDD格式的数字
        - from_unixtime(date) ： 把unix时间戳转化为普通格式的时间，与unix_timestamp(date)函数互为反函数
    - 返回utc日期的函数 utc_date() ： 返回当前utc(世界标准时间)日期值，其格式为 'YYYY-MM-DD'或YYYYMMDD，具体格式取决于函数用在字符串或数据语境中
    - 返回utc时间的函数 utc_time() ： 返回当前utc时间值，其格式为''HH:MM:SS'或HHMMSS，具体格式取决于函数用在字符串或数据语境中
    - 获取月份的函数
        - month(date) ： 返回date对应的月份
        - monthname(date) ： 返回日期date对应月份的英文全名
    - 获取星期的函数
        - dayname(d) ： 返回d对应的工作日的英文名称
        - dayofweek(d) ： 返回d对应的一周中的索引。1表示周日，2表示周一
        - weekday(d) ： 返回d对应的工作日索引。0表示周一，1表示周二
    - 获取星期数的函数
        - week(d) ： 计算日期d是一年中的第几周。
        - weekofyear(d) ： 计算某天位于一年中的第几周，范围是1～53
    - 获取天数的函数
        - dayofyear(d) ： 返回d是一年中的第几天，范围是1～366
        - dayofmonth(d) ： 返回d是一个月中的第几天，范围是1～31
    - 获取年份的函数  year(date) ： 返回date对应的年份，范围是1970～2069
    - 获取季度的函数  quarter(date) ： 返回date对应的一年中的季度值，范围是1～4
    - 获取分钟的函数  minute(time) ： 返回time对应的分钟数，范围是0～59
    - 获取秒的函数  second(time) ： 返回time对应的秒数，范围是0～59
    - 获取日期的指定值的函数 extract(type from date) ： 所使用的时间间隔类型说明符与date_add()或date_sub()的相同，但它从日期中提取一部分，而不是执行日期运算
    - 时间和秒钟转换的函数
        - time_to_sec(time) ： 返回已转化为秒的time参数。转化公式为：小时*3600+分钟*60+秒
        - sec_to_time(seconds) ： 返回被转化为小时、分钟和秒数的seconds参数值，其格式为"HH:MM:SS"或HHMMSS，具体格式根据该函数用在字符串或数字语境中而定
    - 计算日期和时间的函数
        - date_add(date,interval expr type) 和 date_sub(date,interval expr type)中，date是一个datetime或date值。用来指定起始时间。expr是一个表达式，用来指定从起始日期添加或减去的时间间隔值。对于负值的时间间隔，expr可以以一个负号-开头。type为关键词，它指示了表达式被解释的方式.
        - date_add(date,interval expr type) 和 adddate(date,interval expr type) 两个函数的作用相同，执行日期的加运算。
        - date_sub(date,interval expr type) 和 subdate(date,interval expr type) 两个函数的作用相同，执行日期的减运算。
        - addtime(date,expr) ： 将expr值添加到date，并返回修改后的值，date是一个日期或日期时间表达式，而expr是一个时间表达式。
        - subtime(date,expr) ： date减去expr值，并返回修改后的值，date是一个日期或者日期时间表达式，而expr是一个时间表达式。
        - datediff(date1,date2) ： 返回起始时间date1和结束时间date2之间的天数。date1和date2为日期或日期时间表达式。计算中只用到这些值的日期部分。
    - 将日期和时间格式化的函数
        - date_format(date,format) ： 根据format指定的格式显示date值。
        - time_format(time,format) ： 根据format字符串安排time值的格式。format字符串可能仅会处理包含小时、分钟和秒的格式说明福，其他说明符产生一个null或0。
        - get_format(val_type,format_type) ： 返回日期时间字符串的显示格式，val_type表示日期数据类型，包括date、datetime和time；format_type表示格式化显示类型，eur、interval、iso、jis、usa。
- 条件判断函数
    - if(expr,v1,v2) : 若表达式expr是true，则if()的返回值为v1；否则返回值为v2。返回的值为数字或字符串，具体情况视其所在语境而定
    - ifnull(v1,v2) ： 若v1不为null，则ifnull()的返回值为v1；否则其返回值为v2。返回的值为数字或字符串，具体情况视其所在语境而定
    - case expr when v1 then r1 [when v2 then r2] [else rn] end ： 若expr值等于某个vn，则返回对应位置then后面的结果；若与所有值都不相等，则返回else后面的rn
- 系统信息函数
    - 获取mysql版本号、连接数和数据库名的函数
        - version() ： 返回指示mysql服务器版本的字符串。这个字符串使用utf8字符集
        - connection_id() ： 返回mysql服务器当前连接的次数，每个连接都有各自唯一的id
        - processlist命令的输出结果显示有哪些线程在运行，不仅可以查看当前所有的连接数，还可以查看当前的连接状态，帮助识别出有问题的查询语句等。
            show processlist；只列出前100条，若想全部列出，则可使用show full processlist
        - database() 和 schema() ： 返回使用utf8字符集的默认(当前)数据库名
    - 获取用户名的函数
        - user()
        - current_user
        - current_user()
        - system_user()
        - session_user()
    - 获取字符串的字符集和排序方式的函数
        - charset(str) ： 返回字符串str自变量的字符集
        - collation(str) ： 返回字符串str的字符排列方式
    - 获取最后一个自动生成的ID值的函数
        - last_insert_id() ： 自动返回最后一个insert或update为auto_increment列设置的第一个发生的值
- 加密函数
    - password(str) ： 用原明文密码str计算并返回加密后的密码字符串，当参数为null时，返回null
    - md5(str) ： 为字符串算出一个md5 128比特校验和。该值以32位十六进制数字的二进制字符串形式返回，若参数为null，则会返回null
    - encode(str，pswd_str) ：使用pswd_str作为密码，加密str。使用decode()解密，结果是一个和str长度相同的二进制字符串。
    - 解密函数 decode(crypt_str,pswd_str) ： 使用pswd_str作为密码，解密加密字符串crypt_str，crypt_str是由encode()返回的字符串
- 其他函数
    - 格式化函数 format(x,n) ： 将数字x格式化，并以四舍五入的方式保留小数点后n位，结果以字符串的形式返回。若n为0，则返回结果函数不含小数部分
    - 不同进制的数字进行转化的函数 conv(m,from_base,to_base) ： 进行不同进制数间的转换。返回值为数值n的字符串表示，由from_base进制转化为to_base进制。若有任意一个参数为null，则返回值为null。自变量n被理解为一个整数，但是可以被指定为一个整数或字符串。最小基数为2，而最大基数为36。
    - IP地址与数字相互转换的函数 inet_aton(expr) ： 给出一个作为字符串的网络地址的点地址表示，返回一个代表该地址数值的整数。地址可以是4bit或8bit地址。
    - inet_ntoa(expr) ： 给定一个数字网络地址（4bit或8bit）， 返回作为字符串的该地址的点地址表示
    - 加锁函数和解锁函数
        - get_lock(str,timeout) ： 设法使用字符串str给定的名字得到一个锁，超时为timeout秒。若成功得到锁，则返回1；若操作超时，则返回0；若发生错误，则返回null。假如有一个用get_lock()得到的锁，当执行release_lock()或连接断开(正常或非正常)时，这个锁就会解除。
        - release_lock(str) ： 解开被get_lock()获取的用字符串str命名的锁。若锁被解开时，则返回1；若该线程尚未创建锁，则返回0(此时锁没有被解开)；若命名的锁不存在，则返回null，若该锁从未被get_lock()的调用获取，或锁已经被提前解开，则该锁不存在
        - is_free_lock(str) ： 检查名为str的锁是否可以使用(换言之，没有被封锁)。若锁可以使用，则返回1(没有人在用这个锁)；若这个锁正在被使用，则返回0；若出现错误，则返回null(诸如不正确的参数)
        - is_used_lock(str) ： 检查名为str的锁是否正在被使用(换言之，被封锁)。若被封锁，则返回使用该锁的客户端的连接标识符；否则返回null
    - 重复执行指定操作的函数 benchmark(count,expr) ： 重复count次执行表达式expr。它可以用于计算mysql处理表达式的速度。结果值通常为0(0只是表示处理过程很快，并不是没有话费时间)。另一个作用是它可以在mysql客户端内部报告语句执行的时间
    - 改变字符集的函数 convert(...using...) ： 表示带有using的convert()函数被用来在不同的字符集之间转化数据
    - 改变数据类型的函数 cast(x,as type) 和 convert(x.type) 函数将一个类型的值转换为另一个类型，可转换的type有binary、char(n)、date、time、datetime、decimal、signed、unsigned
    
### 查询数据
- 基本查询语句
    - group by <字段>，该子句告诉mysql如何显示查询出来的数据，并按照指定的字段分组
    - order by <字段>，该子句告诉mysql按什么样的顺序显示查询出来的数据，可以进行的排序有升序（asc）和降序（desc）
    - limit [<offset>,] <row count>，该子句告诉mysql每次显示查询出来的数据条数
    - 执行过程：select语句决定了要查询的列值，from子句指定了数据的来源
    
- 单表查询
    - 查询所有字段
        - 在select语句中使用星号(*) 通配符查询所有字段
        - 在select语句中指定所有字段
    - 查询指定字段
        - 查询单个字段
        - 查询多个字段
    - 查询指定记录
        - 通过where子句可以对数据进行过滤
    - 带in关键字的查询
        - in操作符用来查询满足指定范围的条件的记录，使用in操作符将所有检索条件用括号括起来，检索条件之间用逗号分隔开，满足条件范围的值即为匹配项
    - 带between and 的范围查询
        - between and用来查询某个范围内的值，该操作符需要两个参数，即范围的开始值和结束值，若字段值满足指定的范围查询条件，则这些记录被返回
    - 带like的字符匹配查询
        - 百分号通配符"%"匹配任意长度的字符，甚至包括零字符
        - 下划线通配符"_"一次只能匹配任意一个字符
    - 查询空值 使用is null子句可以查询某字符内容为空记录
    - 带and的多条件查询 使用and操作符限定只有满足所有查询条件的记录才会被返回，可以使用and连接两个甚至多个查询条件，多个条件表达式之间用and分开
    - 带or的多条件查询 使用or操作符表示只需要满足其中一个条件的记录即可返回。
    - 查询结果不重复 使用distinct关键字指示mysql消除重复的记录值。
    - 对查询结果排序 使用order by子句对查询对结果进行排序
        - 单列排序 
        - 多列排序
        - 指定排序方向
    - 分组查询
        - 分组查询是对数据按照某个或多个字段进行分组。使用group by 关键字对数据进行分组
        - [group by 字段] [having <条件表达式>] （指定满足表达式限定条件的结果将被显示）
        - 创建分组
            - group by关键字通常和集合函数一起使用，如：man()、min()、count()、sum()、avg()
        - 使用having过滤分组
            - group_by可以和having一起限定显示记录所需满足的条件，只有满足条件的分组才会被显示
            - having在数据分组之后进行过滤来选择分组，而where在分组之前用来选择记录，where排除的记录不再包括在分组中
        - 在group by子句中使用with rollup
            - 使用with rollup关键字之后，在所有查询出的分组记录之后增加一条记录，该记录计算查询出的所有记录总和，即统计记录数量
        - 多字段分组
        - group by 和 order by 一起使用
        - rollup 和order by是互相排斥的
    - 使用limit限制查询结果的数量
    
- 使用集合函数查询
    - count() ： 统计数据表中包含的记录行的总数，或者根据查询结果返回列中包含的数据行数
    - sum() ： 一个求总和的函数，返回指定列值的总和，在计算时，忽略列值为null的行
    - avg() ： 通过计算返回的行数和每一行数据的和求得指定列数据的平均值
    - max() ： 返回指定列中的最大值
    - min() ： 返回查询列中的最小值
    
- 连接查询
    - 内连接查询(inner join) ：使用比较运算符进行表间某(些)列数据的比较操作，并列出这些表中与连接条件相匹配的数据行，组合成新的记录。在内连接查询中，只有满足条件的记录才能出现在结果关系中
    - 外连接查询
        - left join(左连接) ： 返回包括左表中的所有记录和右表中连接字段相等的记录
        - right join(右连接) ： 返回包括右表中的所有记录和左表中连接字段相等的记录
    - 复合条件连接查询 ： 在连接查询的过程中通过添加过滤条件限制查询的结果，使查询的结果更加准确
    
- 子查询
    - 带any、some关键字的子查询 ： 同义词，表示满足其中任一条件，它们允许创建一个表达式对子查询的返回值列表进行比较，只要满足内层子查询中的任何一个比较条件，就返回一个结果作为外层查询的条件
    - 带all关键字的子查询 ： 需要同时满足所有内层查询的条件
    - 带exists关键字的子查询 ： 后面的参数是一个任意的子查询，系统对子查询进行运算以判断它是否返回行，如果至少返回一行，那么exists的结果为true，此时外层查询语句将进行查询；如果子查询没有返回任何行，那么exists返回的结果是false，此时外层语句将不进行查询
    - 带in关键字的子查询 ： 内层查询语句仅返回一个数据列，这个数据列里的值将提供给外层查询语句进行比较操作
    - 带比较运算符的子查询 
    
- 合并查询结果
    - 利用union关键字可以给出多条select语句，并将它们的结果组合成单个结果集。合并时，两个表对应的列数和数据类型必须相同。各个select语句之间使用union或union all关键字分隔。union不使用关键字all，执行的时候删除重复的记录，所有返回的行都是唯一的。使用关键字all的作用是不删除重复行，也不对结果进行自动排序
    
- 为表和字段取别名

- 使用正则表达式查询
    - 使用regexp关键字指定正则表达式的字符匹配模式
    - 查询以特定字符或字符串开头的记录
        - 字符"^"匹配以特定字符或者字符串开头的文本
    - 查询以特定字符或字符串结尾的记录
        - 字符"$"匹配以特定字符或者字符串结尾的文本
    - 用符号"."替代字符串中的任意一个字符
    - 使用"*"和"+"来匹配多个字符
        - "*"匹配前面的字符任意多次，包括0次
        - "+"匹配前面的字符至少一次
    - 匹配指定字符串
    - 匹配指定字符中的任意一个
        - "[]" 指定一个字符集合，只匹配其中任何一个字符，即为所查找的文本
    - 匹配指定字符以外的字符
        - "[^字符集合]"匹配不在指定集合中的任何字符
    - 使用{n,}或者{n,m}指定字符串连续出现的次数
        - {n,} 表示至少匹配n次前面的字符
        - {n,m} 表示匹配前面的字符串不少于n次，不多于m次
    
### 插入、更新与删除数据
- 插入数据
    - 为表的所有字段插入数据
    - 为表的指定字符插入数据
    - 同时插入多条记录
        - records ： 表明插入的记录条数
        - duplicates ： 表明插入时被忽略的记录，原因可能是这些记录包含重复的主键值
        - warnings ： 表明有问题的数据值，例如发生数据类型转换
    - 将查询结果插入表中
    
- 更新数据
    
- 删除数据

- mysql5.7新特性——为表增加计算列
    - 某一列的值是通过别的列计算得来的
    
### 索引
- 索引简介
    - 索引是对数据库表中一列或多列的值进行排序的一种结构，使用索引可提高数据库中特定数据的查询速度
    - 索引的含义和特点
        - 索引是一个单独的、存储在磁盘上的数据库结构，它们包含着对数据表里所有记录的引用指针。
        - 使用索引用于快速找出某个或多个列中有一特定值的行，所有列类型都可以被索引，对相关列使用索引是提高查询操作速度的最佳途径。
        - 索引是在存储引擎中实现的，因此，每种存储引擎的索引都不一定完全相同，并且每种存储引擎也不一定支持所有索引类型。根据存储引擎定义每个表的最大索引数和最大索引长度。所有存储引擎支持每个表至少16个索引，总索引长度至少为256字节。大多数存储引擎有更高的限制。mysql中索引的存储类型有两种：btree和hash，具体和表的存储引擎相关；myisam和innodb存储引擎只支持btree索引；memory/heap存储引擎可以支持hash和btree索引。
        - 索引的优点：
            - 1.通过创建唯一索引可以保证数据库表中每一行数据的唯一性。
            - 2.可以大大加快数据的查询速度，这也是创建索引的最主要的原因。
            - 3.在实现数据的参考完整性方面，可以加速表和表之间的连接。
            - 4.在使用分组和排序子句进行数据查询时，也可以显著减少查询中分组和排序的时间。
        - 增加索引也有许多不利的方面：
            - 1.创建索引和维护索引要耗费时间，并且随着数据量的增加所耗费的时间也会增加。
            - 2.索引需要占磁盘空间，除了数据表占数据空间之外，每一个索引还要占一定的物理空间，如果有大量的索引，索引文件可能比数据文件更快达到最大文件尺寸。
            - 3.当对表中的数据进行增加、删除和修改的时候，索引也要动态地维护，这样就降低列数据的维护速度。
    - 索引的分类
        - 普通索引和唯一索引
            - 普通索引： 基本索引类型，允许在定义索引的列中插入重复值和空值。
            - 唯一索引： 索引列的值必须唯一，但允许有空值。
            - 组合索引： 列值的组合必须唯一。
            - 主键索引： 特殊的唯一索引，不允许有空值。
        - 单列索引和组合索引
            - 单列索引： 一个索引只包含单个列，一个表可以有多个单列索引。
            - 组合索引： 在表的多个字段组合上创建的索引，只有在查询条件中使用了这些字段的左边字段时，索引才会被使用。使用组合索引时遵循最左前缀集合。
        - 全文索引
            - 全文索引类型为fulltext，在定义索引的列上支持值的全文查找，允许在这些索引列中插入重复值和空值。全文索引可以在char、varchar或者text类型的列上创建。mysql中只有myisam存储引擎支持全文索引。
        - 空间索引
            - 空间索引是对空间数据类型的字段建立的索引，mysql中的空间数据类型有4中，分别是geometry、point、linestring和polygon。mysql使用spatial关键字进行扩展，使得能够用于创建正规索引类似的语法创建空间索引。创建空间索引的列必须声明为not null，空间索引只能在存储引擎为myisam的表中创建。
    - 索引的设计原则
        - 1. 索引并非越多越好，一个表中如果有大量的索引，不仅占用磁盘空间，而且会影响insert、delete、update等语句的性能，因为在表中的数据更改的同时，索引也会惊醒调整和更新。
        - 2. 避免对经常更新的表进行过多的索引，并且索引中的列尽可能少。而对经常用于查询的字段应该创建索引，但要避免添加不必要的字段。
        - 3. 数据量小的表最好不要使用索引，由于数据较少，查询花费的时间可能比遍历索引的时间还要短，索引可能不会产生优化效果。
        - 4. 在条件表达中经常用到的不同值较多的列上建立索引，在不同值很少的列上不要建立索引。
        - 5. 当唯一性是某种数据本身的特征时，指定唯一索引。使用唯一索引需能确保定义的列的数据完整性，以提高查询速度。
        - 6. 在频繁进行排序或分组的列上建立索引，如果带排序的列有多个，可以在这些列上建立组合索引。
    
- 创建索引
    - 创建表的时候创建索引
        - 创建普通索引 ： 最基本的索引类型没有唯一性之类的限制，其作用只是加快对数据的访问速度。
        - 使用explain语句查看索引是否正在使用：
            - 1. select_type ： 指定所使用的select查询类型，simple表示简单的select，不使用union或子查询。其他可能的取值有primary、union、subquery等。
            - 2. table ： 指定数据库读取的数据表的名字，它们按被读取的先后顺序排列。
            - 3. type ： 指定本数据表与其他数据表之前的关联关系，可能的取值有system、const、eq_ref、ref、range、index和all。
            - 4. possible_keys ： 给出了mysql在搜索数据记录时可选用的各个索引。
            - 5. key ： mysql实际选用的索引。
            - 6. key_len ： 给出索引按字节计算的长度，key_len数值越小，表示越快。
            - 7. ref ： 给出了关联关系中另一个数据表里的数据列的名字。
            - 8. rows ： mysql在执行这个查询时预计会从这个数据表里读出的数据行的个数。
            - 9. Extra ： 提供了与关联操作有关的信息。
        - 创建唯一索引 ： 主要原因是减少查询索引列操作的执行时间，尤其是对比较庞大的数据表。
            - 使用unique关键字创建唯一索引。
        - 创建单列索引 ： 在数据表中的某一个字段上创建的索引，一个表中可以创建多个单列索引。
        - 创建组合索引 ： 在多个字段上创建一个索引。
        - 创建全文索引 ： fulltext全文索引可以用于全文搜索。只有myisam存储引擎支持fulltext索引，并且只为char、varchar和text列创建索引。索引总是对整个列进行，不支持局部（前缀）索引。
        - 创建空间索引 ： 必须在myisam类型的表中创建，且空间类型的字段必须为非空。
    - 在已经存在的表上创建索引
        - 使用alter table语句创建索引
            - 使用show index 语句查看指定表中创建的索引
                - 1. table表示创建索引的表。
                - 2. non_unique表示索引非唯一，1代表非唯一索引，0代表唯一索引。
                - 3. key_name表示索引的名称。
                - 4. seq_in_index表示该字段在索引中的位置，单列索引该值为1，组合索引为每个字段在索引定义中的顺序。
                - 5. column_name表示定义索引的列字段。
                - 6. sub_part表示索引的长度。
                - 7. null表示给字段是否能为空值。
                - 8. index_type表示索引类型。
        - 使用create index 创建索引
    
- 删除索引
    - 使用alter table 删除索引
        - 添加auto_increment约束字段的唯一索引不能被删除
    - 使用drop index 语句删除索引
    
### 存储过程和函数
- 创建存储过程和函数
    - 存储程序可以分为存储过程和函数，mysql中创建存储过程和函数使用的语句分别是：create procedure 和 create function。使用call语句调用存储过程只能用输出变量返回值。函数可以从语句外调用（通过引用函数名），也能返回标量值。存储过程也可以调用其他存储过程。
    - 创建存储过程
        - 基本语法格式： create procedure sp_name([proc_parameter]) [characteristics...] routine_body
            - create procedure 为创建存储过程的关键字；sp_name为存储过程的名称；
            - proc_parameter 为指定存储过程的参数列表，列表形式 ： [in｜out｜inout] param_name type
                - in表示输入参数；out表示输出参数；inout表示既可以输入，也可以输出；param_name表示参数名称；type表示参数的类型，该类型可以是mysql数据库中的任意类型。
                - characteristics ： 指定存储过程的特性，有以下取值
                    - language sql ： 说明routine_body部分是由sql语句组成的，当前系统支持的语言为sql，sql是language特性的唯一值。
                    - [not] deterministic ： 指明存储过程执行的结果是否正确。表示结果是确定的。每次执行存储过程时，相同的输入会得到相同的输出。not deterministic表示结果是不确定，相同的输入可能得到不同的输出。如果没有指定任意一个值，默认为not deterministic。
                    - {contains sql ｜ no sql ｜ reads sql data ｜ modifies sql data} ： 指明子程序使用sql语句的限制。contains sql表明子程序包含sql语句，但是不包含读写数据的语句；no sql表明子程序不包含sql语句；reads sql data说明子程序包含读数据的语句；modifies sql data 表明子程序包含写数据的语句。默认为contains sql。
                    - sql security {definer ｜ invoker} ： 指明谁有权限来执行。definer表示只有定义者才能执行。invoker表示拥有权限的调用者可以执行。默认为definer。
                    - comment "string" ： 注释信息，可以用来描述存储过程或函数。
                - routine_body 是sql代码的内容，可以用begin...end表示sql代码的开始和结束。
        - delimiter // 语句的作用是将mysql的结束符设置为//
    - 创建存储函数
        - 使用create function语句
        - returns 子句只能对function指定，对函数而言这是强制的。它用来指定函数的返回类型，而且函数体必须包含一个return value语句。
    - 变量的使用
        - 定义变量 使用declare语句定义变量
        - 为变量赋值 使用set语句为变量赋值
    - 定义条件和处理程序
        - 定义条件 使用declare语句 ： declare condition_name condition for [condition_type]
        - 定义处理程序 ： declare handler_type handler for condition_value [,...] sp_statement
    - 光标的使用
        - 光标必须在声明处理程序之前被声明，并且变量和条件必须在声明光标或处理程序之前被声明。
        - 声明光标 ： declare cursor_name cursor for select_statement
        - 打开光标 ： open cursor_name
        - 使用光标 ： fetch cursor_name into var_name [,var_name] ... {参数名称}
        - 关闭光标 ： close cursor_name
        - 光标只能在存储过程和函数中使用。
    - 流出控制的使用
        - if 语句 ： 包含多个条件判断，根据判断的结果为ture或false执行相应的语句。
        - case 语句 ： 另一个进行条件判断的语句。
        - loop 语句 ： 用来重复执行某些语句，与if和case语句相比，loop只是创建一个循环操作的过程，并不进行条件判断。
        - leave 语句 ： 用来退出任何被标注的流出控制构造
        - iterate 语句 ： 将执行顺序转到语句段开头处。只可以出现在loop、repeat和while语句内。必须跟在循环标志前面。
        - repeat 语句 ： 创建一个带条件判断的循环过程，每次语句执行完毕之后，会对条件表达式进行判断，如果表达式为真，就结束循环；否则重复执行循环中的语句。
        - while 语句 ： 创建一个带条件判断带循环过程，与repeat不同，while语句执行时，先对指定对表达式进行判断，如果为真，就执行循环内对语句，否则退出循环。
    
- 调用存储过程和函数
    - 调用存储过程
        - 使用call语句进行调用
    - 调用存储函数
        
- 查看存储过程和函数
    - 使用show status语句查看存储过程和函数的状态
    - 使用show create语句查看存储过程和函数的定义
    - 从information_schema.Routines表中查看存储过程和函数的信息
    
- 修改存储过程和函数
    - 使用alter语句可以修改存储过程或汗水的特性。
    
- 删除存储过程和函数
    - 删除存储过程和函数可以使用drop语句。
    
### 视图
- 视图概述
    - 视图的含义
        - 视图是一个虚拟表，是从数据库中一个或多个表中导出来的表。视图还可以从已经存在的视图基础上定义。
        - 视图一经定义便存储在数据库中，与其相对应的数据并没有像表那样在数据库中再存储一份，通过视图看到的数据只是存放在基本表中的数据。对视图的操作与对表的操作一样，可以对其进行查询、修改和删除。当对通过视图看到的数据进行修改时，相应的基本表的数据也要发生变化；同时，若基本表的数据发生变化，则这种变化可以自动地反映到视图中。
    - 视图的作用
        - 简单化
        - 安全性
        - 逻辑数据独立性
      
- 创建视图
    - 创建视图的语法形式 ： create view
    - 在单表上创建视图
    - 在多表上创建视图
    
- 查看视图
    - 使用describe语句查看视图基本信息，间写desc
    - 使用show table status语句查看视图基本信息
    - 使用show create view语句查看视图详细信息
    - 在views表中查看视图详细信息
    
- 修改视图
    - 使用create or replace view语句修改视图
    - 使用alter语句修改视图
    
- 更新视图
    - 使用update语句更新视图
    - 使用insert语句在基本表中插入一条数据
    - 使用delete语句删除视图中的一条记录
    - 视图包含一下内容时，更新操作不能被执行
        - 视图中不包含基表中被定义为非空的列
        - 在定义视图的select 语句后的字段列表中使用了数学表达式
        - 在定义视图的select 语句后的字段列表中使用了聚合函数
        - 在定义视图的select 语句中使用了distinct、 union、top、group by或having子句。
    
- 删除视图
    - 删除一个或多个视图可以使用drop view 语句
    
- 视图和表的区别：
    - 1. 视图是已经编译好的sql语句，是基于sql语句的结果集的可视化的表，而表不是。
    - 2. 视图没有实际的物理记录，而表有。
    - 3. 表是内容，视图是窗口。
    - 4. 表占用物理空间而视图不占用物理空间。视图只是逻辑概念的存在，表可以及时对它进行修改，但视图只能用创建的语句来修改。
    - 5. 视图是查看数据表的一种方法，可以查询数据表中某些字符构成的数据，只是一些sql语句的集合。从安全的角度来说，视图可以放置用户接触数据表，因而用户不知道表结构。
    - 6. 表属于全局模式中的表，是实表；视图属于局部模式的表，是虚表。
    - 7. 视图的建立和删除只影响视图本身，不影响对应的基本表。
    
- 视图和表的联系：
    - 视图是在基本表之上建立的表，它的结构(所定义的列)和内容(所有记录) 都来自基本表，它依据基本表存在而存在。一个视图可以对应一个基本表，也可以对应多个基本表。视图是基本表的抽象和在逻辑意义上建立的新关系。
    
### mysql触发器
- 创建触发器
    - 触发器是个特殊的存储过程，不同的是，执行存储过程要使用call语句来调用，而触发器的执行不需要使用call语句来调用，也不需要手工启动，当一个预定义的事件发生的时候，就会被mysql自动调用。
    - 创建只有一个执行语句的触发器
    - 创建有多个执行语句的触发器
    
- 查看触发器
    - show triggers 语句查看触发器信息
    - 在information_schema.triggers表中查看触发器信息
    
- 触发器的使用
    - 触发程序是与表有关的命名数据库对象，当表上出现特定事件时，将激活该对象。在某些触发程序的用法中，可用于检查插入表中的值，或对更新涉及的值进行计算。
    - 可以将触发程序设置为在执行语句之前或之后激活。
    
- 删除触发器
    - 使用drop trigger 语句可以删除mysql中已经定义的触发器。
    
### mysql权限与安全管理
-权限表
    - user表
        - mysql中最重要的一个权限表，记录允许连接到服务器的账号信息，里面的权限是全局级的。
        - 用户列 ： Host、User、authentication_string ： 主机名、用户名和密码。
        - 权限列 ： 
        - 安全列 ： 两个是ssl相关的，两个是x509相关的，两个是授权插件相关的。x509标准可用于表示用户；plugin字段表示可以用于验证用户身份的插件
        - 资源控制列 ： 
            - max_questions ： 用户每小时允许执行的查询操作次数。
            - max_updates ： 用户每小时允许执行的更新操作次数。
            - max_connections ： 用户每小时允许执行的连接操作次数。
            - max_user_connections ： 用户允许同时建立的连接次数。
    - db表
        - mysql数据中非常重要的权限表。存储列用户对某个数据库的操作权限，决定用户能从哪个主机存取哪个数据库。
        - 用户列 ： Host、User、Db，标识从某个主机连接某个用户对某个数据库的操作权限。
        - 权限列 ： create_routine_priv和alter_routine_priv这两个字段表明用户是否有创建和修改存储过程的权限。
    - tables_priv表和columns_priv表
        - tables_priv ： 用来对表设置操作权限
            - host、db、user和table_name ： 主机名、数据库名、用户名和表名。
            - Grantor ： 修改该记录的用户。
            - Timestamp ： 修改该记录的时间。
            - Table_priv ： 对表的操作权限包括：select、insert、update、delete、greate、drop、grant、references、index和alter。
            - column_priv ： 对表中的列的操作权限，包括select、insert、update和references。
        - columns_priv ： 用来对表的某一列设置权限。
            - column_name ： 指定对哪些数据列具有操作权限。
    - procs_priv 表
        - 可以对存储过程和存储函数设置操作权限。
        - host、db和user ： 主机名、数据库名和用户名。
        - routine_name ： 存储过程或函数的名称。
        - routine_type ： 存储过程或函数的类型。function表示这是一个函数；procedure表示这是一个存储过程。
        - grantor ： 插入或修改该记录的用户。
        - proc_priv ： 拥有的权限，包括execute、alter Routine、grant。
        - timestamp ： 记录更新时间。
- 账户管理
    - 登录和退出mysql服务器
        - -h主机名，可以使用该参数指定主机名或IP，如果不指定，默认是localhost。
        - -u用户名，可以使用该参数指定用户名。
        - -p密码，可以使用该参数指定登录密码。
        - -P端口号，该参数后面接mysql服务器的端口号，默认为3306。
        - 数据库名，可以在命令的最后指定数据库名。
        - -e执行sql语句。如果指定了该参数，将在登录后执行-e后面的命令或sql语句并退出。
    - 新建普通用户
        - 使用create user 语句创建新用户
        - 使用grant 语句创建新用户
        - 直接操作mysql用户表
    - 删除普通用户
        - 使用drop user 语句删除用户
        - 使用delete 语句删除用户
    - root 用户修改自己的密码
        - 使用mysqladmin 命令在命令行指定新密码。
        - 修改mysql数据库的user表，需要执行flush privileges语句重新加载用户权限。
        - 使用set语句修改root用户的密码
    - root 用户修改普通用户密码
        - 使用set语句修改普通用户的密码
        - 使用update语句修改普通用户的密码
        - 使用grant 语句修改普通用户密码
    - 普通用户修改密码
        - 通过set语句设置自己的密码
    - root 用户密码丢失的解决办法
        - 使用--skip-grant-tables选项启动mysql服务
        - 使用root用户登录，重新设置密码
        - 加载权限表
    
- 权限管理
    - mysql的各种权限
        - 账户权限信息被存储在mysql数据库的user、db、host、tables_priv、columns_priv和procs_priv表中。
        - create和drop 权限可以创建新数据库和表，或删除已有数据库和表。
        - select、insert、update和delete 权限允许在一个数据库现有的标上实施操作。
        - select 权限只有在用户真正从一个表中检索行时才被用到。
        - index 权限允许在创建或删除索引，index适用于已有表中。
        - alter 权限可以使用alter table来更改表的结构和重新命名表。
        - create routine 权限用来创建保存的程序(函数和成勋)，alter routine权限用来更改和删除保存的程序，execute 权限用来执行保存的程序。
        - grant 权限允许授权给其他用户，可用于数据库、表和保存的程序。
        - file 权限允许用户使用load data infile和select..into outfile语句读或写服务器上的文件。
        - 不同权限下可以使用的mysqladmin命令
            - reload 命令告诉服务器将授权表重新读入内存；flush-privileges是reload的同义词；refresh命令清空所有表并关闭/打开记录文件；其他flush-xxx命令执行类型refresh的功能，但是范围有限，并且在某些情况下可能更好用。
    - 授权
        - 全局层级 ： 适用于一个给定服务器中的所有数据库。
        - 数据库层级 ： 适用于一个给定数据库中的所有目标。
        - 表层级 ： 适用于一个给定表中的所有列。
        - 列层级 ： 适用于一个给定表中的单一列。
        - 子程序层级 ： 
            - create routine、alter routine、execute和grant 权限适用于已存储的子程序。这些权限可以被授予为全局层级和数据库层级。而且，除了create routine外，这些权限可以被授予子程序层级，存储在mysql.procs_priv表中。
    - 收回权限
        - 使用revoke语句取消用户的某些权限。必须和from语句一起使用，from语句指明需要收回权限的账户。
    - 查看权限
        - show grants 语句可以显示指定用户的权限信息。
    
- 访问控制
    - 连接核实阶段
    - 请求核实阶段
    
- mysql5.7的新特性——提升安全性
    - aes 256加密
        - 1. aes_encode()
        - 2. aes_decode()
        - 3. 将加密字符串存入数据表中
    - 密码到期更换策略
        - 允许数据库管理员手动设置账户密码过期时间。通过设置default_password_lifetime参数可以设置账户过期时间。
    - 安全模式安装
        - 提升mysql安装的安全性：
            - 1. 为root账户设置密码
            - 2. 移除能从本地主机以外的地址访问数据的root账户
            - 3. 移除匿名账户
            - 4. 移除test数据库，该数据库默认可被任意用户甚至匿名账户访问。
        - 使用mysqld -initialize命令安装mysql实例默认是安全的，原因如下：
            - 1. 在安装过程中只创建一个root账户，自动为这个账户生产一个随机密码并标记密码过期。
            - 2. 数据库管理员必须用root账户及该随机密码登录并设置一个新密码后才能对数据库进行正常操作。
            - 3. 安装过程不创建任何匿名账户
            - 4. 安装过程不创建test数据库
    
### 数据备份与恢复
- 数据备份
    - 使用mysqldump命令备份
        - mysqldump -u user -h host -ppassword dbname[tbname,tbname...] > filename.sql
        - 使用mysqldump备份单个数据库中的所有表
        - 使用mysqldump备份数据库中的某个表
        - 使用mysqldump备份多个数据库，使用--databases参数之后，必须指定至少一个数据库的名称，多个数据库名称之间用空格隔开。
            - 使用--all-databases参数可以备份系统中所有的数据库，不需要指定数据库名称
    - 直接负值整个数据库目录
    - 使用mysqlhotcopy工具快速备份
    
- 数据恢复
    - 使用mysql命令恢复
        - mysql -u user -p [dbname] < filename.sql
        - 如果已经登录mysql服务器，还可以使用source命令导入sql文件。source filename，执行source命令前，必须使用use语句选择数据库
    - 直接负值到数据库目录
    - mysqlhotcopy快速恢复
    
- 数据库迁移
    - 相同版本的mysql数据库之间的迁移
    - 不同版本的mysql数据库之间的迁移
    - 不同数据库之间的迁移
    
- 表的导出和导入
    - 使用selecti ...into outfile导出文本文件
    - 使用mysqldump命令导出文本文件
        - mysqldump -T path -u root -p dbname [tbales] [options]
        - 只有指定了-T参数才可以导出纯文本文件；path表示导出数据的目录；tables为指定要导出的表名称，如果不指定，将导出数据库dbname中所有的表；[options] 为可选参数选项，这些选项需要结合-T选项使用。
            - --fields-terminated-by=value ： 设置字段之间的分隔字符，可以为单个或多个字符，默认情况下为制表符""\t"。
            - --fields-enclosed-by=value ： 这是字符的包围字符。
            - --fields-optionally-enclosed-by=valye ：设置字段的包围字符，只能为单个字符，只能包括char和varchar等字符数据字段。
            - --fields-escaped-by=value ： 控制如何写入或读取特殊字符，只能为单个字符，即设置转移字符，默认值问反斜线""\"。
            - --lines-terminated-by=value ： 设置每行数据结尾的字符，可以为单个或多个字符，默认值为""\n"。
    - 使用mysql命令导出文本文件
        - 如果mysql服务器是单独的机器，用户是在一个client上进行操作的，用户要把数据结果导入client机器上，可以使用mysql -e语句。 mysql -u root -p --execute=""select 语句" dbname > filename.txt
        - 使用--vertical参数显示结果
        - 将查询结果导出到html文件中，使用--html选择即可。
    - 使用load data infile方式导入文本文件
    - 使用mysqlimport命令导入文本文件
      
### mysql日志
- 日志简介
    - mysql日志主要分为4类：
        - 1. 错误日志 ： 记录mysql服务的启动、运行或停止mysql服务时出现的问题。
        - 2. 查询日志 ： 记录建立的客户端连接和执行的语句。
        - 3. 二进制日志 ： 记录所有更新数据的语句，可以用于数据复制。
        - 4. 慢查询日志 ： 记录所有执行时间超过long_query_time的所有查询或不使用索引的查询。
- 二进制日志
    - 主要记录mysql数据库的变化。包含关于每个更新数据库的语句的执行时间信息。
    - 主要目的是最大可能地恢复数据库，因为二进制日志包含备份后进行的所有更新。
    - 启动和设置二进制日志
    - 查看二进制日志
        - 使用show binary logs查看二进制日志文件的个数及文件名
    - 删除二进制日志
        - 使用reset master 语句删除所有二进制日志文件
        - 使用purge master logs 语句删除指定日志文件
    - 使用二进制日志恢复数据库
        - 可以使用mysqlbinlog工具从指定的时间点开始直到现在，或从另一个指定的时间点的日志中恢复数据。
        - mysqlbinlog [option] filename | mysql -uuser -ppass
    - 暂时停止二进制日志功能
        - set sql_log_bin 语句可以使用mysql暂停或者启动二进制日志
    
- 错误日志
    - 包含mysqld启动和停止时，以及服务器在运行过程中发生任何严重错误时的相关信息。会将启动和停止数据库信息已经一些错误信息记录到错误日志文件中。
    - 启动和设置错误日志
        - 启动和停止已经指定日志文件名都可以通过修改my.ini（my.cnf）来配置。
    - 查看错误日志
        - show variables like 'log_error';
    - 删除错误日志
        - 重建日志文件，在服务器端执行：mysqladmin -u root -p flush-logs
        - 在客户端登录mysql数据库，执行：flush logs 语句
    
- 通用查询日志
    - 记录mysql的所有用户操作，包括启动和关闭服务、执行查询和更新语句等。
    - 启动和设置通用查询日志
        - 在my.ini（my.cnf）的[mysqld]组下加入log选项
    - 查看通用查询日志
    - 删除通用查询日志
        - 重新建立新的日志文件，可使用语句mysqladmin -u root -p flush-logs
    
- 慢查询日志
    - 启动和设置慢查询日志
        - 配置文件：log-slow-queries选项打开
        - 在mysql服务启动的时候使用--log-slow-queries[=file_name]启动慢查询日志。
    - 查看慢查询日志
    - 删除慢查询日志
    
### 性能优化
- 优化简介
    - 找出系统的瓶颈，提高mysql数据库整体的性能；另一方面需要合理的结构设计和参数调整，以提高用户操作响应的速度；同时还要尽可能节省系统资源，以便系统可以提供更大负荷的服务。
    - 原则是减少系统的瓶颈，减少资源的占用，增加系统的反应速度。例如，通过优化文件系统提高磁盘I/O的读写速度；通过优化操作系统调度策略提高mysql在高负荷情况下的负载能力；优化表结构、索引、查询语句等使查询响应更快。
    - 使用show status 语句查询一些mysql数据库的性能参数 ： show status like "(value)"
        - Connections ： 连接mysql服务器的次数
        - Uptime ： mysql 服务器的上线时间
        - Slow_queries ： 慢查询的次数
        - Com_select ： 查询操作的次数
        - Com_insert ： 插入操作的次数
        - Com_update ： 更新操作的次数
        - Com_delete ： 删除操作的次数
    
- 优化查询
    - 分析查询语句
        - explain 语句和 describe 语句用来分析查询语句
            - select_type ： 表示select 语句的类型。
                - 1. simple ： 表示简单查询，其中不包括连续查询和子查询；
                - 2. primary ： 表示主查询，或者是最外层的查询语句；
                - 3. union ： 表示连接查询的第2个或后面的查询语句；
                - 4. dependent union ： 连接查询中的第2个或后面的select语句，取决于外面的查询
                - 5. union result ： 连接查询的结果
                - 6. subquery ： 子查询中的第1个select语句
                - 7. dependent subquery ： 子查询中的第1个select，取决于外面的查询
                - 8. derived ： 导出表的select(from子句的子查询)
            - table ： 表示查询的表
            - type ： 表示表的连接类型。按照从最佳类型到最差类型的顺序给出各种连接类型：
                - 1. system ： 该表是仅有一行的系统表。这是const连接类型的一个特例。
                - 2. const ： 数据表最多只有一个匹配行，它将在查询开始时被读取，并在余下的查询优化中作为常量对待。const表查询速度很快，因为只读取一次。const用于使用常数值比较primary key 或 unique 索引的所有部分的场合。
                - 3. eq_ref ： 对于每个来自前面的表的行组合，从该表中读取一行。当一个索引的所有部分都在查询中使用并且索引是unique 或 primary key时，即可使用这种类型。可以用于使用"=" 操作符比较带索引的列。比较值可以为常量或一个在该表前面所读取的表的列的表达式。
                - 4. ref ： 对于来自前面的表的任意行组合，将从该表中读取所有匹配的行。这种类型用于索引既不是unique又不是primary key的情况，或者查询中使用了索引列的左子集，即索引中左边的部分列组合。可以用于使用"='或"<=>"操作符的带索引的列。
                - 5. ref_or_null ： 该连接类型如同ref，但是添加了mysql可以专门搜索包含null的行。在解决子查询中经常使用该连接类型的优化。
                - 6. index_merge ： 该连接类型表示使用了索引合并优化方法，在这种情况下，key列包含使用的索引的清单，key_len包含使用的索引的最长关键元素。
                - 7. unique_subquery ： 该类型替换了的in子查询的ref，是一个索引查找函数，可以完全替换子查询，效率更高。
                - 8. index_subquery ： 该连接类型类似于unqiue_subquery，可以替换in子查询，但只适合子查询中的非唯一索引。
                - 9. range ： 只检索给定范围的行，使用一个索引来选择行。key列显示使用了哪个索引。key_len包含所使用索引的最长关键元素。
                - 10. index ： 该连接类型与all相同，除了只扫描索引树外。通常比all快，因为索引文件通常比数据文件小。
                - 11. all ： 对于前面的表的任意行组合进行完整的表扫描。
            - possible_keys ： 指出mysql能使用哪个索引在该表中找到行。若该列是null，则没有相关的索引。在这种情况下，可以通过检查where子句看它是否引用某些列或适合索引的列来提高查询性能。如果是这样，可以创建适合的索引来提高查询的性能。
            - key ： 表示查询实际使用的索引，如果没有选择索引，该列的值是null。要想强制mysql使用或忽视possible_keys列中的索引，在查询中使用force index、use index或者ignore index。
            - key_len ： 表示mysql选择的索引字段按字节计算的长度，若键是null，则长度为null。注意，通过ken_len值可以确定mysql将实际使用一个多列索引中的几个字段。
            - ref ： 表示使用哪个列或常数与索引一起来查询记录。
            - rows ： 显示mysql在表中进行查询时必须检查的行数。
            - Extra ： 表示mysql在处理查询时的详细信息。
    - 索引对查询速度的影响
        - 提高性能的一个最有效的方式是对数据表设计合理的索引。索引提高了高效访问数据的方法，对查询的速度有着至关重要的影响。使用索引可以快速地定位表中的某条记录，从而提高数据库查询的速度，提高数据库的性能。
    - 使用索引查询
        - 有可能使用带有索引的字段查询时，索引并没有起作用。
            - 使用like关键字的查询语句  如果匹配字符串的第一个字符为"%"，索引不会起作用。只有'%'不在第一个位置，索引才会起作用。
            - 使用多列索引的查询语句 一个索引可以包括16个字段。对于多列索引，只有查询条件中使用了这些字段中第1个字段时，索引才会被使用。
            - 使用or关键字的查询语句 查询语句的查询条件中只有or关键字，且or前后的两个条件中的列都是索引时，查询中才使用索引。否则，查询将不使用索引。
    - 优化子查询
        - 使用连接（join）查询来代替子查询。
    
- 优化数据库结构
    - 数据库结构的设计需要考虑数据冗余、查询和更新的速度、字段的数据类型是否合理等多方面的内容。
    - 将字段很多的表分解成多个表
    - 增加中间表
    - 增加冗余字段
        - 问题 ： 冗余字段的值在一个表中被修改来，就要想办法在其他表中更新该字段。否则会使原本一致的数据变得不一致。
    - 优化插入记录的速度
        - 禁用索引
        - 禁用唯一性检查
        - 使用批量插入
        - 使用load data infile批量导入
            - 禁用唯一行检查 set unique_checks=0 禁止，1开启
            - 禁用外键检查 set foreign_key_checks 
            - 禁止自动提交 set autocommit 
    - 分析表、检查表和优化表
        - 分析表
            - 分析关键字的分布
            - analyze table table_name
        - 检查表
            - 检查表主要是检查表是否存在错误
            - check table table_name
        - 优化表
            - 消除删除或者更新造成的空间浪费
            - optimize table 
    
- 优化mysql服务器
    - 优化服务器硬件
        - 配置较大的内存
        - 配置高速磁盘系统，以减少读盘的等待时间，提高响应速度。
        - 合理分布磁盘I/O，把磁盘I/O分散在多个设备上，以减少资源竞争，提高并行操作能力。
        - 配置多处理器，mysql是多线程的数据库，多处理器可同时执行多个线程。
    - 优化mysql的参数
        - key_buffer_size ： 表示索引换冲区的大小。
        - table_cache ： 表示同时打开的表的个数。
        - query_cache_size ： 表示查询缓冲区的大小。该参数需要和query_cache_type配合使用。适用于修改操作少且经常执行相同的查询操作的情况。
        - sort_buffer_size ： 表示排序缓存区的大小。值越大，排序的速度越快。
        - read_buffer_size ： 表示每个线程连续扫描时为扫描的每个表分配的缓冲区的大小。当线程从表中连续读取记录时需要用到这个缓冲区。
        - read_rnd_buffer_size ： 表示为每个线程保留的缓冲区的大小，与read_buffer_size相似。但主要用于存储按特定顺序读取出来但记录。
        - innodb_buffer_pool_size ： 表示innodb类型的表和索引的最大缓存。这个值越大，查询的速度就会越快。但是这个值太大会影响操作系统的性能。
        - max_connections ： 表示数据库的最大连接数。这个连接数不是越大越好，因为这些连接会浪费内存的资源，过多的连接可能会导致mysql服务器僵死。
        - innodb_flush_log_at_trx_commit ： 表示何时将缓冲区的数据写入日志文件，并且将日志文件写入磁盘中。
        - back_log ： 表示在mysql暂时停止回答新请求之前的短时间内，多少个请求可以被存在堆栈中。该值表示对到来的TCP/IP连接的侦听队列的大小。只有期望在一个短时间内有很多连接，才需要增加该参数的值。
        - interactive_timeout ： 表示服务器在关闭连接前等待行动的秒数。
        - sort_buffer_size ： 表示每个需要进行排序的线程分配的缓冲区的大小。增加这个值可以提高order by或group by操作的速度。
        - thread_cache_size ： 表示可以复用的线程的数量。
        - wait_timeout ： 表示服务器在关闭一个连接时等待行动的秒数。
    
- mysql5.7新特性1——临时表性能优化
- mysql5.7新特性2——服务器语句超时处理
    - 通过设置系统变量max_execution_time来实现
- mysql5.7新特性3——支持创建全局通用表空间

### mysql replication
- mysql replication 概述
    - mysql复制是指从一个mysql主服务器(master)将数据复制到另一台或多台mysql从服务器(slave)到过程，将主数据库的DDL和DML操作通过二进制日志传到从服务器上，然后在从服务器上对这些日志重新执行，从而使得主从服务器的数据保持同步。
    - mysql数据库复制操作大致可以分为三个步骤：
        - 1. 主服务器将数据的改变记录到二进制日志(binary log)中。
        - 2. 从服务器将主服务器的binary log events复制到它的中继日志(relay log)中。
        - 3. 从服务器重做中继日志中的事件，将数据的改变与从服务器保持同步。
    
- 日常管理和维护
    - 了解服务器的状态
        - 使用show slave status 命令来检查从服务器
        - slave_io_running ： 此进程是否能够由从服务器到主服务器上正确地读取binlog日志，并写入从服务器的中继日志中。
        - slave_sql_running ： 能否读取并执行中继日志中的binlog信息。
    - 服务器复制出错的原因
    
### mysql cluster
- mysql cluster 概述
    - mysql cluster 基本概念
        - 是一种mysql集群的基数，是由一组计算机构成的，每台计算机可以存放一个或者多个节点，其中包块mysql服务器、DNB Cluster 的数据节点、其他管理节点以及专门的数据访问程序，这些节点组合在一起，就可以为应用提供高性能、高可用性和可缩放性的Cluster数据管理。
        - 访问过程 ： 应用通常使用一定的负载均衡算法将对数据的访问分散到不同的sql节点，sql节点对数据节点进行数据访问并从数据节点返回数据结果，管理节点只是对sql节点和数据节点进行配置管理。
    - 理解mysql cluster 节点
        - 管理节点
            - 用来对其他节点进行管理。通常通过配置config.ini文件来配置集群中有多少需要维护的副本，配置每个数据节点上为数据和索引分配多少内存、IP地址，以及在每个数据节点上保存数据的磁盘路径。
        - sql节点
            - 就是mysql服务器，应用不能直接访问数据节点，只能通过sql节点访问数据节点来返回数据。任何一个sql节点都是连接到所有的存储节点的，所有当任何一个存储节点发生故障的适合，sql节点都可以把请求转移到另一个存储节点执行。sql节点越多越好，分配到每个sql节点的负载就越小，系统的整体性能就越好。
        - 数据节点
            - 数据节点用来存放cluster里面的数据，mysql cluster在各个数据节点之间复制数据，任何一个节点发生了故障，始终会有另外的数据节点存储数据。
    
